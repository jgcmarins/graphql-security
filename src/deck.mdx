import { Head, Image } from 'mdx-deck'
import Code from 'mdx-code';
import { CodeSurfer } from "mdx-deck-code-surfer";

import { Cover } from './Cover';
import { Intro } from './Intro';
import { Tweet } from './Tweet';
import { Attacks } from './Attacks';
import { LimitQuery } from './LimitQuery';
import { DisableIntrospection } from './DisableIntrospection';
import { Authorization } from './Authorization';
import { LimitIntrospection } from './LimitIntrospection';
import { WhiteList } from './WhiteList';
import { PersistedQueries } from './PersistedQueries';
import { Other } from './Other';
import { References } from './References';
import { Thanks } from './Thanks'

export { default as theme } from './theme'

<Head>
  <title>GraphQL Security</title>
</Head>

<Cover />

---

<Intro />

---
<div style={{ fontSize: 28 }}>
<CodeSurfer
  title="Road Map"
  code={require('!raw-loader!./topics.txt')}
  showNumbers={false}
  dark={true}
  lang="txt"
  steps={[
    { range: [1, 1] },
    { range: [2, 2] },
    { range: [3, 3] },
    { range: [4, 4] },
    { range: [5, 5] },
    { range: [6, 6] },
    { range: [7, 7] },
    { range: [8, 8] },
    { range: [9, 9] },
    { range: [10, 10] },
  ]}
/>
</div>

---
<div style={{fontSize: 28}}>
<CodeSurfer
  title="Overview"
  code={require('!raw-loader!./overview.txt')}
  showNumbers={false}
  dark={true}
  lang="bash"
  steps={[
    { range: [1, 1], notes: 'Fetches data'},
    { range: [3, 3], notes: 'Mutates data'},
    { range: [5, 5], notes: 'Updates when a mutation happens'},
  ]}
/>
</div>

---

<Tweet />

---
<div style={{fontSize: 26}}>
<CodeSurfer
  title="Overview - app.ts"
  code={require('!raw-loader!./app.ts')}
  showNumbers={false}
  dark={true}
  lang="typescript"
  steps={[
    { range: [1, 16], notes: 'Koa imports'},
    { range: [18, 37], notes: 'App setup'},
    { range: [39, 46], notes: 'Expose Playground'},
    { range: [48, 62], notes: 'Setup Koa + GraphQL Context'},
    { range: [64, 82], notes: '/graphql'},
    { range: [90, 112], notes: 'Error handling'},
  ]}
/>
</div>

---

<Attacks />

---

<LimitQuery />

---

<DisableIntrospection />

---

<Authorization />

---

<LimitIntrospection />

---

<WhiteList />

---

<PersistedQueries />

---

<Other />

---

<div style={{fontSize: 28}}>
<CodeSurfer
  title="Middleware"
  code={require('!raw-loader!./middleware.txt')}
  showNumbers={false}
  dark={true}
  lang="bash"
  steps={[
    { range: [1, 1], notes: 'https://github.com/alekbarszczewski/graphql-add-middleware'},
  ]}
/>
</div>

---

<div style={{fontSize: 26}}>
<CodeSurfer
  title="Middleware - applyMiddlewares.ts"
  code={require('!raw-loader!./applyMiddlewares.ts')}
  showNumbers={false}
  dark={true}
  lang="typescript"
  steps={[
    { range: [1, 9] },
  ]}
/>
</div>

---

<div style={{fontSize: 26}}>
<CodeSurfer
  title="Middleware - requiredRolesMutation.ts"
  code={require('!raw-loader!./requiredRolesMutation.ts')}
  showNumbers={false}
  dark={true}
  lang="typescript"
  steps={[
    { range: [1, 6], notes: 'Imports' },
    { range: [7, 13], notes: 'function Signature' },
    { range: [14, 24], notes: 'Check if middleware is present' },
    { range: [26, 30], notes: 'Validate middleware' },
    { range: [32, 39], notes: 'Return errors' },
  ]}
/>
</div>

---

<div style={{fontSize: 26}}>
<CodeSurfer
  title="Middleware - GiveGodModeMutation.ts"
  code={require('!raw-loader!./GiveGodModeMutation.ts')}
  showNumbers={false}
  dark={true}
  lang="typescript"
  steps={[
    { range: [1, 7], notes: 'Imports' },
    { range: [9, 15], notes: 'function, name, inputFields' },
    { range: [16, 31], notes: 'mutateAndGetPayload' },
    { range: [32, 41], notes: 'outputFields' },
    { range: [44, 47], notes: 'export default' },
  ]}
/>
</div>

---

<References />

---

<Thanks />
